actor BdRocket replaces Rocket
{
    Radius 10
    Height 8
    Speed 35
    Damage 35
    DamageType Explosive
    Scale 0.7
    Decal "Scorch"
    SeeSound "weapons/rocket/fly"
    DeathSound "explosions/explode"
    Obituary "$OB_MPROCKET"
    
    Projectile
    -BLOODSPLATTER
    -RANDOMIZE
    +EXTREMEDEATH
    +BLOODSPLATTER 
    +THRUSPECIES
    +MTHRUSPECIES
    
    States
    {
    Spawn:
        TNT1 A 0 NoDelay
        {
            if (GameType() == 2) //Deathmatch
            {
                A_ChangeFlag("THRUSPECIES", 0);
                A_ChangeFlag("MTHRUSPECIES", 0);
            }
        }
    Fly:
        MISL A 1 Bright
        {
            A_PlaySound("weapons/rocket/fly");
            A_SpawnItem("RocketFlare", -20, 0);
            A_SpawnItem("SmokeTrail");
            A_SpawnProjectile("SmokeTrail", 2, 0, random(160, 210), CMF_AIMDIRECTION, random(-30, 30));
        } 
        loop

    Death:
        TNT1 A 0 
        {
            A_Quake(3, 8, 0, 960);
            A_SpawnProjectile("BigRicochet");
            A_SpawnItemEx("DetectFloorCrater", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION);
            A_SpawnItemEx("DetectCeilCrater",  0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION);
            A_SpawnItemEx("ExplosionFlare",    0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION);
        }
        TNT1 AAAAAAAAA 0 A_SpawnProjectile("ExplosionParticleHeavy", 0, 0, random(0, 360), CMF_AIMDIRECTION, random(0, -180))
        TNT1 AAAAAAAAAAAAAAAAAA 0 A_SpawnProjectile("ExplosionParticleHeavy", 0, 0, random(0, 360), CMF_AIMDIRECTION, random(0, -360))
        TNT1 AAAAAAAAA 0 A_SpawnProjectile("ExplosionParticleVeryFast", 0, 0, random(0, 360), CMF_AIMDIRECTION, random(0, -360))
        TNT1 AAAAA 0 A_SpawnProjectile("MediumExplosionFlames", 0, 0, random(0, 360), CMF_AIMDIRECTION, random(0, -360))
        TNT1 AAAAA 0 A_SpawnProjectile("ExplosionSmoke", 0, 0, random(0, 360), CMF_AIMDIRECTION, random(0, -360))
        TNT1 A 0 A_SpawnItemEx("RocketExplosionDamage", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION)
        TNT1 A 2
        TNT1 A 20 A_PlaySound("explosions/far", 3)
        stop
    }
}

/** Inventory class used to count up the time until a grenade explodes */
actor GrenadeTime : Inventory
{
    Inventory.MaxAmount 6
}

/** Grenades aren't really implemented as weapons, but they can be used with the Zoom function on weapons. They're projectiles that bounce and are affected by gravity. */
ACTOR BdGrenade
{
    Radius 4
    Height 4
    Speed 30
    Gravity 0.7
    Scale 0.2
    BounceFactor 0.5
    WallBounceFactor 0.25
    SeeSound "weapons/grenade/bounce"
    Obituary "%o ate %k's grenade."
    DamageType Explosive
    
    Projectile
    -NOGRAVITY
    -BLOODSPLATTER
    -EXTREMEDEATH
    +EXPLODEONWATER
    +SKYEXPLODE
    +DOOMBOUNCE
    
    States
    {
    Spawn:
        GRND ABCDEFGH 2
        TNT1 A 0 A_GiveInventory("GrenadeTime", 1)
        TNT1 A 0 A_JumpIfInventory("GrenadeTime", 3, "Explode")
        loop

    Death:
        GRND H 16
        TNT1 A 0 A_GiveInventory("GrenadeTime", 1)
        TNT1 A 0 A_JumpIfInventory("GrenadeTime", 3, "Explode")
        loop
        
    Explode:
        TNT1 A 0 A_NoBlocking
        TNT1 A 0 A_SpawnItem("FragGrenadeExplosion")
        Stop
    }
}

actor FragGrenadeExplosion
{
    +NOBLOCKMAP
    +MISSILE
    Damagetype Explosive
    States
    {
    Spawn:
        TNT1 A 0 NoDelay
        {
            A_NoBlocking;
            A_Explode(200, 400, 0);
            A_Explode(200, 200, 0);
            A_SpawnItem("BigRicochet", 0, -15);
            A_SpawnItemEx("DetectFloorCrater", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION);
            A_SpawnItemEx("DetectCeilCrater",  0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION);
            A_SpawnItemEx("ExplosionFlare",    0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION);
            A_SpawnItemEx("BarrelExplosionDamage", 0, 0, 30, 0, 0, 0, 0, SXF_NOCHECKPOSITION);
            A_SpawnItemEx("BarrelKaboom", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION);
        }
        TNT1 AAAAAAA 0 A_SpawnProjectile("ExplosionFlames", 0, 0, random(0, 360), CMF_AIMDIRECTION, random(0, 360))
        TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_SpawnProjectile("ExplosionParticleHeavy", 0, 0, random(0, 360), CMF_AIMDIRECTION, random(0, -180))
        TNT1 AAAAAA 0 A_SpawnProjectile("ExplosionParticleHeavy", 0, 0, random(0, 360), CMF_AIMDIRECTION, random(0, -180))
        TNT1 A 0 A_Quake(2, 24, 0, 960)
        TNT1 A 0 A_PlaySound("explosions/explode", CHAN_AUTO)
        TNT1 A 0 A_PlaySound("explosions/far", CHAN_AUTO)
        TNT1 A 0 A_AlertMonsters
        TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_SpawnProjectile("ShrapnelParticle", 0, 0, random(0, 360), CMF_AIMDIRECTION, random(-5, -90))
        TNT1 A 0 A_PlaySound("explosions/far", CHAN_ITEM)
        TNT1 A 0 A_SpawnItem("SmokeColumn")
        TNT1 AAAAAAAAAAAAAAA 8 A_SpawnProjectile("ExplosionSmoke", 1, 0, random(0, 360), CMF_AIMDIRECTION, random(-50, -130))
        stop
    }
}

/** Flag given to the player to make them recoil when a kick has connected. */
actor KickHasHit : Inventory
{
    Inventory.MaxAmount 1
}

/** Used to get the player to animate different melee attacks in a combo formation */
actor PSeq1 : Inventory
{
    Inventory.MaxAmount 2
}

/** Used to get the player to animate different melee attacks in a combo formation */
actor PSeq2 : Inventory
{
    Inventory.MaxAmount 1
}

actor KickAttack: FastProjectile
{
    Radius 10
    Height 6
    DamageType Kick
    Damage (random(38, 42))
    Speed 30
    
    Projectile 
    +NOEXTREMEDEATH
    
    States
    {
    Spawn:
        TNT1 A 2
        stop
        
    Death:
        TNT1 A 0 A_PlaySound("weapons/melee/heavy", CHAN_ITEM)
        TNT1 A 0 A_GiveToTarget("KickHasHit", 1)
        TNT1 A 10 A_Quake(2, 6, 0, 320)
        stop
    }
}

actor MeleeStrike1: KickAttack
{
    DamageType Kick
    Damage (random(10, 15))
    Speed 30

    States
    {
    Spawn:
        TNT1 A 1
        stop

    Death:
        TNT1 A 10 A_PlaySound("weapons/melee/heavy")
        stop
    }
}

actor MeleeStrike2: MeleeStrike1
{
    Damage (random(24, 32))
    Speed 40
}

actor MeleeStrike1Smash: MeleeStrike1
{
    Damage (random(24, 32))
    DamageType SuperKick
}